<div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">手工记账</h4>
        </div>
        <form class="form-horizontal" role="form" method="post" action="/member/add">
            <div class="modal-body">
                <div class="form-group">
                    <label for="date" class="col-sm-2 control-label help-block">消费日期</label>
                    <div class="col-sm-10">
                        <input type="text" id="date" name="date" class="form-control" placeholder="请选择日期">
                        <span class="add-on"><i class="icon-th"></i></span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="kind" class="col-sm-2 control-label help-block">收支类型</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="kind" name="kind" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label for="type" class="col-sm-2 control-label help-block">账目分类</label>
                    <div class="input-append date col-sm-10">
                        <input type="text" class="form-control" id="type" name="type" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label for="cash" class="col-sm-2 control-label help-block">金额</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="cash" name="cash" placeholder="单位：元 （请输入数字，输错很2）">
                    </div>
                </div>
                <div class="form-group">
                    <label for="account" class="col-sm-2 control-label help-block">资金账户</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="account" name="account" placeholder="">
                    </div>
                </div>

                <div class="form-group">
                    <label for="remark" class="col-sm-2 control-label help-block">备注</label>
                    <div class="col-sm-10">
                        <textarea class="form-control" rows="3" id="remark" name="remark" placeholder=""></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary">确认并保存</button>
            </div>
        </form>
    </div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->

<script>
    /**
     通用加载select控件的option方法
     参数:
     url - 调用的action
     param - 参数  写法:'key1=value1&key2=value2'
     value - select的默认值(没有则传null)
     select - select控件的引用 (document.getElementById('...'))

     action返回值为json数据,格式为['display':...,'value':..]的数组
     */
    function loadSelectOption(url,param,value,select){
        ajaxRemote(url,param,
                function(data){
                    select.options.length=0;
                    for(var i=0;i<data.length;i++){
                        var obj=data[i];
                        var option=document.createElement('option');
                        option.value=obj['value'];
                        option.innerHTML=obj['display'];

                        if(option.value==value){
                            option.selected='selected';
                        }
                        select.appendChild(option);
                    }
                },'json');
    }

    function loadPoint(){
        var select=document.getElementById('select_point');
        var url='${ctx}/invoiceInputOrder/ajaxGetAllPoint.action';
        if("${queryMap['stockInPointId'][0]}" == "" || "${queryMap['stockInPointId'][0]}" == undefined){
            loadSelectOption(url,null,null,select);
        }else{
            loadSelectOption(url,null,"${queryMap['stockInPointId'][0]}",select);
        }

    }

    function pointChange(){
        var select=document.getElementById('select_user');
        var url='${ctx}/invoiceInputOrder/ajaxGetUser.action';
        var pId  = document.getElementById('select_point').value;
        if(pId==null || pId==undefined || pId==""){
            pId = "${queryMap['stockInPointId'][0]}";
        }
        var param={pointId:pId};
        if("${queryMap['stockInUserId'][0]}" == "" || "${queryMap['stockInUserId'][0]}" == undefined){
            loadSelectOption(url,param,null,select);
        }else{
            loadSelectOption(url,param,"${queryMap['stockInUserId'][0]}",select);
        }
    }
    /*
     <td width="120" align=right>
     <span>请求网点：</span>
     </td>
     <td width="120">
     <select id="select_point" name="queryMap['stockInPointId']"  onchange="pointChange();"></select>
     </td>
     <td width="120" align=right>
     <span>请求柜员：</span>
     </td>
     <td width="120">
     <select id="select_user" name="queryMap['stockInUserId']" ></select>
     </td>
    */

    $(function(){
        /** 日期 **/
        $('#date').datepicker({
            todayBtn: "linked",
            language: "zh-CN",
            format: "yyyy/mm/dd"
        });

        loadPoint();
        pointChange();
    });
</script>
